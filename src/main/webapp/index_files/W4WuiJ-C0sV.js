/*!CK:804724510!*//*1408337429,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["fR1aE"]); }

__d("CurationOneClickButton",["Banzai","CSS","cx","DOM","Event","SaveState","SaveStateHandler","tidyEvent"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o="saved_for_later:click",p="remove",q="_vu",r="_54nc",s="_vv";function t(u,v,w,x,y,z){"use strict";this.$CurationOneClickButton0=false;var aa=null;y.forEachItem(function(ba){if(ba.getValue()==p)aa=j.find(ba.getRoot(),'a.'+r);});n([k.listen(v,'click',this.setSaving.bind(this,x)),k.listen(v,'error',this.setUnsaved.bind(this,x)),k.listen(w,'click',this.logFlyoutClick.bind(this,z)),k.listen(aa,'error',this.setSaved.bind(this,x)),y.subscribe('itemclick',function(ba,ca){var da=ca.item.getValue();if(da==p)this.setUnsaving(x);}.bind(this))]);m.listen([x],function(ba){switch(ba){case l.SAVING:h.addClass(u,q);h.addClass(y.getRoot(),s);this.$CurationOneClickButton0=true;break;case l.SAVED:h.addClass(u,q);h.removeClass(u,s);h.removeClass(y.getRoot(),s);this.$CurationOneClickButton0=false;break;case l.UNSAVING:h.removeClass(u,q);h.addClass(u,s);v.setAttribute('rel','');this.$CurationOneClickButton0=true;break;case l.UNSAVED:h.removeClass(u,q);h.removeClass(u,s);h.removeClass(y.getRoot(),s);v.setAttribute('rel','async-post');this.$CurationOneClickButton0=false;break;}}.bind(this));}t.prototype.setSaving=function(u){"use strict";if(!this.$CurationOneClickButton0)m.saving([u]);};t.prototype.setUnsaving=function(u){"use strict";if(!this.$CurationOneClickButton0)m.unsaving([u]);};t.prototype.setSaved=function(u){"use strict";m.saved([u]);};t.prototype.setUnsaved=function(u){"use strict";m.unsaved([u]);};t.prototype.logFlyoutClick=function(u){"use strict";g.post(o,{og_object_id:u.og_object_id,collection_id:u.collection_id,surface:u.surface,mechanism:u.mechanism});};e.exports=t;},null);
__d("VertexWikipediaController",["Arbiter","DOM","DOMEventListener","DOMQuery","clickRefAction","copyProperties","csx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(p,q,r,s,t,u,v){this._seeMore=p;this._attribution=q;this._wikiSrc=r;this._loading=s;this._url=t;this._scrollableArea=u;this._subsection=v;if(this._subsection!==null){this.showFullArticle(null);}else i.add(p,'click',this.showFullArticle.bind(this));}l(o.prototype,{showFullArticle:function(p){if(p)k('vertex',this._seeMore,p,'FORCE',null);var q=j.find(this._seeMore,"^._5a- ._3nq");h.remove(q);var r=j.find(this._seeMore,"^._3nm ._3no");h.appendContent(r,q);var s=j.find(this._seeMore,"^._5a-");h.empty(s);h.appendContent(s,this._loading);h.appendContent(s,this._attribution);this._loadToken=g.subscribe('wikipedia/loaded',this.onArticleLoaded.bind(this),g.SUBSCRIBE_NEW);var t=h.create('script',{src:this._wikiSrc},null);h.find(document,'head').appendChild(t);},onArticleLoaded:function(p,q){if(q.url!=this._url)return;this._scrollableArea.poke();if(this._subsection){var r=n(this._subsection);if(r)this._scrollableArea.setScrollTop(r.offsetTop,true);}g.unsubscribe(this._loadToken);}});e.exports=o;},null);