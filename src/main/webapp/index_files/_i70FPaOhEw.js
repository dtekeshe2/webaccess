/*!CK:620028346!*//*1408389811,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["C\/63Q"]); }

__d("SystemEvents",["Arbiter","CurrentUser","ErrorUtils","SystemEventsInitialData","UserAgent_DEPRECATED","copyProperties","setIntervalAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=new g(),o=[],p=1000;m(function(){for(var z=0;z<o.length;z++)o[z]();},p);function q(){return (/c_user=(\d+)/.test(document.cookie)&&RegExp.$1)||0;}function r(){if(j.ORIGINAL_USER_ID){return j.ORIGINAL_USER_ID;}else return h.getID();}var s=r(),t=navigator.onLine;function u(){if(!t){t=true;n.inform(n.ONLINE,t);}}function v(){if(t){t=false;n.inform(n.ONLINE,t);}}if(k.ie()){if(k.ie()>=11){window.addEventListener('online',u,false);window.addEventListener('offline',v,false);}else if(k.ie()>=8){window.attachEvent('onload',function(){document.body.ononline=u;document.body.onoffline=v;});}else o.push(function(){(navigator.onLine?u:v)();});}else if(window.addEventListener)if(!k.chrome()){window.addEventListener('online',u,false);window.addEventListener('offline',v,false);}var w=s;o.push(function(){var z=q();if(w!=z){n.inform(n.USER,z);w=z;}});var x=Date.now();function y(){var z=Date.now(),aa=z-x,ba=aa<0||aa>10000;x=z;if(ba)n.inform(n.TIME_TRAVEL,aa);return ba;}o.push(y);o.push(function(){if(window.onerror!=i.onerror)window.onerror=i.onerror;});l(n,{USER:'SystemEvents/USER',ONLINE:'SystemEvents/ONLINE',TIME_TRAVEL:'SystemEvents/TIME_TRAVEL',isPageOwner:function(z){return (z||q())==s;},isOnline:function(){return k.chrome()||t;},checkTimeTravel:y});e.exports=n;},null);
__d("ChannelSubdomain",["Event","JSLogger","Run","setTimeoutAcrossTransitions","LogHistory","WebStorage"],function(a,b,c,d,e,f,g,h,i,j){var k=b('LogHistory').getInstance('channel'),l=b('WebStorage').getLocalStorage(),m=h.create('channel'),n='channel_sub:',o=7,p=100*1000,q=null,r;function s(){if(r){clearTimeout(r);r=null;}if(l&&q!=null)l.removeItem(n+q);q=null;}function t(u,v,w){var x=(u-1)*o;if(w){if(r)clearTimeout(r);q=r=null;}if(v==null)v=Math.floor(Math.random()*x);if(q==null)if(l){var y=[];for(var z=0;z<l.length;z++){var aa=l.key(z);if(aa.indexOf(n)===0){var ba=parseInt(aa.substr(n.length),10);y[ba]=parseInt(l.getItem(aa),10);}}var ca=Date.now()-p;for(z=0;z<x;z++){var da=(z+v)%x;if(!y[da]||y[da]<ca){q=da;break;}}if(q!=null){var ea=function(){try{l.setItem(n+q,Date.now());}catch(fa){k.warn('subdomain set failed',fa.message);}r=j(ea,p/2);};ea();}else{k.warn('no channel subdomain',y);m.error('subdomain_overflow');}if(typeof window.onpageshow!='undefined'){g.listen(window,'pagehide',s);}else i.onUnload(s);}else q=v;return q==null?null:q%o;}e.exports={allocate:t,clear:s};},null);
__d("DocRPC",["ErrorUtils"],function(a,b,c,d,e,f,g){var h={_apis:{},_dispatch:function(i){var j;try{i=JSON.parse(i);}catch(k){throw new Error('DocRPC unparsable dispatch: "'+i+'"');}if(h._apis.hasOwnProperty(i.api)){var l=h._apis[i.api];if(l[i.method])j=g.applyWithGuard(l[i.method],l,i.args);}if(j===undefined)j=null;return JSON.stringify(j);},publish:function(i,j){h._apis[j]=i;},proxy:function(i,j,k){var l={};k.forEach(function(m){l[m]=function(){var n={api:j,method:m,args:Array.prototype.slice.call(arguments)},o;try{if(i.closed)throw new Error('DocRPC window closed');o=i.DocRPC._dispatch(JSON.stringify(n));}catch(p){g.reportError(p);return;}if(typeof(o)=='string')try{o=JSON.parse(o);}catch(p){throw new Error('DocRPC '+j+'.'+m+' unparsable return: "'+o+'"');}return o;};});return l;}};e.exports=a.DocRPC=h;},null);
__d("ChannelTransport",["copyProperties","bind","AjaxRequest","URI","JSLogger","DocRPC","ChannelConstants","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=k.create('channel');function p(){return (1048576*Math.random()|0).toString(36);}function q(y,z){var aa=y.subdomain;aa=aa===null?'':(aa+'-');var ba=new j(z).setDomain(aa+y.host+'.facebook.com').setPort(y.port).setSecure(j().isSecure());return ba;}function r(y){var z={partition:y.partition,cb:p()};if(y.sticky_token)z.sticky_token=y.sticky_token;var aa=q(y,'/p').setQueryData(z);o.log('start_p',{uri:aa.toString()});var ba=new i('GET',aa);if(i.supportsCORS())ba.xhr.withCredentials=true;var ca=function(da){o.log('finish_p',{xhr:da.toJSON?da.toJSON():da});};ba.timeout=y.P_TIMEOUT;ba.onError=ba.onSuccess=ca;ba.send();}function s(y,z,aa){var ba=new Image(),ca=0,da=function(ga){ba.abort();return ga?z():aa();};ba.onload=function(){o.log('ping_ok',{duration:Date.now()-ca});da(true);};ba.onerror=function(){r(y);da(false);};var ea=n(ba.onerror,10000);ba.abort=function(){if(ea){clearTimeout(ea);ea=null;}ba.onload=ba.onerror=null;};var fa={partition:y.partition,cb:p()};if(y.sticky_token)fa.sticky_token=y.sticky_token;ca=Date.now();ba.src=q(y,'/ping').setQueryData(fa);return ba;}function t(y,z,aa,ba){var ca=new Date(),da=-1;if(y.userActive>0){da=(ca-y.userActive)/1000|0;if(da<0)o.warn('idle_regression',{idleTime:da,now:ca.getTime(),userActive:y.userActive});}var ea={channel:y.user_channel,seq:y.seq,partition:y.partition,clientid:y.sessionID,cb:p(),idle:da,cap:0};if(!!y.watchdog&&y.watchdog.enabled)ea.wtc=y.watchdog.doSerialize();if(y.uid&&y.viewerUid){ea.uid=y.uid;ea.viewer_uid=y.viewerUid;}if(y.sticky_token)ea.sticky_token=y.sticky_token;if('trace_id' in y)ea.traceid=y.trace_id;var fa=!!y.send_active_when_offline;if(fa&&y.is_offline){ea.state='offline';}else if(y.userActive>0&&da<60)ea.state='active';if(y.streamingCapable){ea.mode='stream';ea.format='json';}if(y.profile)ea.profile=y.profile;if(y.capabilities)ea.cap=y.capabilities;var ga=q(y,'/pull').setQueryData(ea),ha=new i('GET',ga);if(i.supportsCORS())ha.xhr.withCredentials=true;ha.timeout=y.streamingCapable?y.STREAMING_TIMEOUT:y.LONGPOLL_TIMEOUT;ha.onJSON=z;ha.onSuccess=aa;ha.onError=function(){var ia=(this.status==12002&&this._time>=y.MIN_12002_TIMEOUT)||(this.status==504&&this._time>=y.MIN_504_TIMEOUT),ja=ia?aa:ba;return ja&&ja.apply(this,arguments);};ha.send();y.inStreaming=y.streamingCapable;return ha;}function u(y){this.manager=y;(this.init&&this.init());}function v(y){u.apply(this,arguments);}g(v.prototype,{logName:'CORS',enterState:function(y,z){if(this._request){this._request.abort();this._request=null;}if(y=='init')n(h(this.manager,'exitState',{status:m.OK,stateId:z.stateId}),3000);if(!/pull|ping/.test(y))return;var aa=this.manager;if(y=='ping'){this._request=s(z,h(aa,'exitState',{status:m.OK,stateId:z.stateId}),h(aa,'exitState',{status:m.ERROR,stateId:z.stateId}));}else if(y=='pull')this._request=t(z,h(aa,'_processTransportData',z.stateId),h(aa,'exitState',{status:m.OK,stateId:z.stateId}),h(aa,'exitState',{status:m.ERROR,stateId:z.stateId}));}});function w(y){o.log('iframe_init_constructor');u.apply(this,arguments);this._iframe=document.createElement('iframe');this._iframe.style.display='none';document.body.appendChild(this._iframe);l.publish(this,'outerTransport');}g(w.prototype,{logName:'iframe',_initIframe:function(y){o.log('iframe_init_start');window.onchanneliframeready=function(){o.log('iframe_resources');return y.resources;};window.onchanneliframeloaded=function(){o.log('iframe_loaded');};if(y){this._iframeURI=q(y,y.path);if(y.bustIframe){var z={partition:y.partition,cb:p()};this._iframeURI.setQueryData(z);}}else this._iframeURI='about:blank';this._iframeProxy=null;try{this._iframe.contentWindow.location.replace(this._iframeURI);o.log('iframe_uri_set');}catch(aa){o.error('iframe_uri_set_error',aa);this.exitState({status:m.ERROR,stateId:y.stateId},aa+'');}},enterState:function(y,z){if(y=='init'){this._initIframe(z);}else if(/idle|ping|pull/.test(y)){if(this._iframeProxy){this._iframeProxy.enterState.apply(this._iframeProxy,arguments);}else if(y!='idle')this.exitState({status:m.ERROR,stateId:z.stateId},'iframe not yet loaded');}else if(y=='shutdown')this._initIframe();},_processTransportData:function(){this.manager._processTransportData.apply(this.manager,arguments);},exitState:function(y){if(this.manager.state=='init'&&y.status==m.OK)this._iframeProxy=l.proxy(this._iframe.contentWindow,'innerTransport',['enterState'],(this._iframeURI+'').replace(/iframe.*/,''));if(/ping|pull/.test(this.manager.state)&&!this._iframeProxy)return;this.manager.exitState.apply(this.manager,arguments);}});function x(){this.init=this.init.bind(this);u.apply(this,arguments);}g(x.prototype,{logName:'iframe(inner)',init:function(){l.publish(this,'innerTransport');try{var z=l.proxy(window.parent,'outerTransport',['_processTransportData','exitState'],top.DocRPC.origin);g(this,z);this.exitState({status:m.OK,stateId:1e+06});}catch(y){o.error('iframe_inner_init_error',y);}},enterState:function(y,z){if(this._request){this._request.abort();this._request=null;}if(y=='ping'){this._request=s(z,h(this,'exitState',{status:m.OK,stateId:z.stateId}),h(this,'exitState',{status:m.ERROR,stateId:z.stateId}));}else if(y=='pull')this._request=t(z,h(this,'_processTransportData',z.stateId),h(this,'exitState',{status:m.OK,stateId:z.stateId}),h(this,'exitState',{status:m.ERROR,stateId:z.stateId}));}});e.exports={getURI:q,Transport:u,CORSTransport:v,IframeTransport:w,IframeInnerTransport:x};},null);
__d("MovingStat",[],function(a,b,c,d,e,f){function g(h){h=h||60000;var i={t:new Date(),count:0,v:0},j=i,k=0,l=0;function m(){var n=new Date()-h;while(j&&j.next&&j.t<n){k-=j.v;l-=j.count;j=j.next;}}this.add=function(n){k+=n;l++;var o=new Date();if(o-i.t<1000){i.v+=n;i.count++;}else{i.next={t:o,v:n,count:1};i=i.next;m();}};this.tally=function(n){n=n||1000;m();return {sum:k,count:l,timeAverage:k*n/h};};}e.exports=g;},null);
__d("Dcode",[],function(a,b,c,d,e,f){var g,h={},i={_:'%',A:'%2',B:'000',C:'%7d',D:'%7b%22',E:'%2c%22',F:'%22%3a',G:'%2c%22ut%22%3a1',H:'%2c%22bls%22%3a',I:'%2c%22n%22%3a%22%',J:'%22%3a%7b%22i%22%3a0%7d',K:'%2c%22pt%22%3a0%2c%22vis%22%3a',L:'%2c%22ch%22%3a%7b%22h%22%3a%22',M:'%7b%22v%22%3a2%2c%22time%22%3a1',N:'.channel%22%2c%22sub%22%3a%5b',O:'%2c%22sb%22%3a1%2c%22t%22%3a%5b',P:'%2c%22ud%22%3a100%2c%22lc%22%3a0',Q:'%5d%2c%22f%22%3anull%2c%22uct%22%3a',R:'.channel%22%2c%22sub%22%3a%5b1%5d',S:'%22%2c%22m%22%3a0%7d%2c%7b%22i%22%3a',T:'%2c%22blc%22%3a1%2c%22snd%22%3a1%2c%22ct%22%3a',U:'%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',V:'%2c%22blc%22%3a0%2c%22snd%22%3a0%2c%22ct%22%3a',W:'%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a',X:'%2c%22ri%22%3a0%7d%2c%22state%22%3a%7b%22p%22%3a0%2c%22ut%22%3a1',Y:'%2c%22pt%22%3a0%2c%22vis%22%3a1%2c%22bls%22%3a0%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a',Z:'%2c%22sb%22%3a1%2c%22t%22%3a%5b%5d%2c%22f%22%3anull%2c%22uct%22%3a0%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a'};(function(){var k=[];for(var l in i){h[i[l]]=l;k.push(i[l]);}k.reverse();g=new RegExp(k.join("|"),'g');})();var j={encode:function(k){return encodeURIComponent(k).replace(/([_A-Z])|%../g,function(l,m){return m?'%'+m.charCodeAt(0).toString(16):l;}).toLowerCase().replace(g,function(l){return h[l];});},decode:function(k){return decodeURIComponent(k.replace(/[_A-Z]/g,function(l){return i[l];}));}};e.exports=j;},null);
__d("PresenceCookieManager",["Cookie","CurrentUser","Dcode","ErrorUtils","JSLogger","PresenceInitialData","PresenceUtil","URI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=l.cookieVersion,p=l.dictEncode,q='presence',r={},s=null,t=null,u=k.create('presence_cookie');function v(){try{var z=g.get(q);if(s!==z){s=z;t=null;if(z&&z.charAt(0)=='E')z=i.decode(z.substring(1));if(z)t=JSON.parse(z);}if(t&&(!t.user||t.user===h.getID()))return t;}catch(y){u.warn('getcookie_error',y);}return null;}function w(){return parseInt(Date.now()/1000,10);}var x={register:function(y,z){r[y]=z;},store:function(){var y=v();if(y&&y.v&&o<y.v){u.debug('stale_cookie',o);return;}var z={v:o,time:w(),user:h.getID()};for(var aa in r)z[aa]=j.applyWithGuard(r[aa],r,[y&&y[aa]],function(ea){ea.presence_subcookie=aa;});var ba=JSON.stringify(z);if(p)ba='E'+i.encode(ba);if(m.hasUserCookie()){var ca=ba.length;if(ca>1024)u.warn('big_cookie',ca);var da=n.getRequestURI(false).isSecure()&&!!g.get('csm');g.set(q,ba,null,null,da);}},clear:function(){g.clear(q);},getSubCookie:function(y){var z=v();if(!z)return null;return z[y];}};e.exports=x;},null);
__d("PresenceState",["Arbiter","ErrorUtils","JSLogger","PresenceCookieManager","copyProperties","debounceAcrossTransitions","setIntervalAcrossTransitions","PresenceInitialData"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=n.cookiePollInterval||2000,p=[],q=[],r=null,s=null,t=0,u=null,v=0,w=['sb2','t2','lm2','uct2','tr','tw','at','wml'],x=i.create('presence_state');function y(){return j.getSubCookie('state');}function z(){t=Date.now();j.store();da(s);}var aa=l(z,0);function ba(ia){if(typeof ia=='undefined'||isNaN(ia)||ia==Number.POSITIVE_INFINITY||ia==Number.NEGATIVE_INFINITY)ia=0;return ia;}function ca(ia){var ja={};if(ia){w.forEach(function(ma){ja[ma]=ia[ma];});if(t<ia.ut)x.error('new_cookie',{cookie_time:ia.ut,local_time:t});}ja.ut=t;for(var ka=0,la=p.length;ka<la;ka++)h.applyWithGuard(p[ka],null,[ja]);s=ja;return s;}function da(ia){v++;t=ba(ia.ut);if(!r)r=m(ga,o);s=ia;if(u===null)u=ia;for(var ja=0,ka=q.length;ja<ka;ja++)h.applyWithGuard(q[ja],null,[ia]);v--;}function ea(ia){if(ia&&ia.ut)if(t<ia.ut){return true;}else if(ia.ut<t)x.error('old_cookie',{cookie_time:ia.ut,local_time:t});return false;}function fa(){var ia=y();if(ea(ia))s=ia;return s;}function ga(){var ia=y();if(ea(ia))da(ia);}j.register('state',ca);g.subscribe(i.DUMP_EVENT,function(ia,ja){ja.presence_state={initial:k({},u),state:k({},s),update_time:t,sync_paused:v,poll_time:o};});(function(){var ia=fa();if(ia){da(ia);}else{x.debug('no_cookie_initial');da(ca());return;}})();var ha={doSync:function(ia){if(v)return;if(ia){z();}else aa();},registerStateStorer:function(ia){p.push(ia);},registerStateLoader:function(ia){q.push(ia);},get:function(){return fa();},getInitial:function(){return u;},verifyNumber:ba};e.exports=ha;},null);
__d("ActiveXSupport",["UserAgent_DEPRECATED"],function(a,b,c,d,e,f,g){var h=null,i={isSupported:function(){if(h!==null)return h;try{if(g.ie()>=11){h=!!new ActiveXObject("htmlfile");}else h=!!window.ActiveXObject&&!!new ActiveXObject("htmlfile");}catch(j){h=false;}return h;}};e.exports=i;},null);
__d("VideoCallSupport",["ActiveXSupport","ChannelConstants","MercuryConfig","UserAgent_DEPRECATED"],function(a,b,c,d,e,f,g,h,i,j){var k={isWebrtcSupported:function(){return i.NewVCGK&&(j.chrome()>=24||j.firefox()>=22);},isVideoCallSupported:function(){if(k.isWebrtcSupported())return true;if(j.windows()){if(j.ie()>=9&&!j.ie64()){return g.isSupported();}else return (j.ie()>=7&&!j.ie64())||j.firefox()>=3.6||j.chrome()>=5||j.opera()>=12;}else if(j.osx()>10.5)return (j.firefox()>=3.6||j.chrome()>=5||j.webkit()>=500||j.opera()>=12);return false;},isPluginInstalled:function(n){if(n==='undefined')n=true;var o=false;if(k.isVideoCallSupported())if(l()){var p=null;try{p=new ActiveXObject('SkypeLimited.SkypeWebPlugin');o=!!p;}catch(q){}p=null;}else o=m(n);return o;},getCapabilities:function(){var n=0;if(k.isPluginInstalled(false))n=n|h.CAPABILITY_SKYPE;if(k.isWebrtcSupported())n=n|h.CAPABILITY_VOIP_INTEROP;return n;}};function l(){return j.ie()&&j.windows()&&!j.opera();}function m(n){if(!navigator)return null;if(n)navigator.plugins.refresh(false);var o=navigator.mimeTypes['application/skypesdk-plugin'];return o&&o.enabledPlugin;}e.exports=k;},null);
__d("ChannelManager",["AjaxRequest","Arbiter","AsyncRequest","ChannelConstants","ChannelInitialData","ChannelSubdomain","ChannelTransport","ChatVisibility","DTSG","Env","FBAjaxRequest","ISB","JSLogger","MovingStat","PresenceCookieManager","PresenceState","PresenceUtil","SystemEvents","URI","UserActivity","VideoCallSupport","copyProperties","createArrayFrom","setIntervalAcrossTransitions","setTimeoutAcrossTransitions","WebStorage"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){var fa=b('WebStorage').getSessionStorage(),ga='chproxy_base_sess',ha,ia=s.create('channel'),ja=null;function ka(wa){ja=wa;}var la={idle:{ok:'init!'},init:{ok:'pull!',error:'reconnect',sys_online:'init',sys_timetravel:'init'},pull:{ok:'pull!',error:'ping',error_missing:'pull',error_msg_type:'pull',refresh_0:'reconnect',refresh_110:'reconnect',refresh_111:'reconnect',refresh_112:'pull',refresh_113:'pull',refresh_117:'reconnect'},ping:{ok:'pull!',error:'ping',error_stale:'reconnect!'},reconnect:{ok:'init!',error:'reconnect',sys_online:'reconnect',sys_timetravel:'reconnect'},shutdown:{},_all:{error_max:'shutdown!',error_shutdown:'shutdown!',sys_owner:'reconnect',sys_nonowner:'idle!',sys_online:'ping',sys_offline:'idle!',sys_timetravel:'ping'}},ma={userActive:Date.now(),sessionID:(Math.random()*2147483648|0).toString(16),capabilities:aa.getCapabilities(),streamingCapable:false,inStreaming:false,LONGPOLL_TIMEOUT:60000,STREAMING_TIMEOUT:60000,P_TIMEOUT:30000,IFRAME_LOAD_TIMEOUT:30000,MIN_RETRY_INTERVAL:5000,MAX_RETRY_INTERVAL:320000,MIN_12002_TIMEOUT:9000,MIN_504_TIMEOUT:20000,STALL_THRESHOLD:180000,JUMPSTART_THRESHOLD:90000,MIN_INIT_PROBE_DELAY:3000,INIT_PROBE_DELAY_RANDOMIZE_RANGE:12000,CHANNEL_PROXY_REPORTING_MIN_INTERVAL:10000,PROBE_DELAY:60000,PROBE_HEARTBEATS_INTERVAL_LOW:1000,PROBE_HEARTBEATS_INTERVAL_HIGH:5000,STREAMING_EXIT_STATE_ON_CONTINUE:false},na={enabled:false,startTimeMillis:Date.now(),accumulatedPullTimeMillis:0,pullStartTimeMillis:0,pingCount:0,pullCount:0,getUptimeSeconds:function(){return (Date.now()-this.startTimeMillis)/1000;},getAccumulatedPullTimeSeconds:function(){return this.accumulatedPullTimeMillis/1000;},getPingToPullRatio:function(){return this.pullCount===0?0:this.pingCount/this.pullCount;},reportPullSent:function(){if(!this.enabled)return;this.pullStartTimeMillis=Date.now();},reportPullReturned:function(wa){if(!this.enabled)return;if(this.pullStartTimeMillis<=0)return;this.accumulatedPullTimeMillis=Date.now()-this.pullStartTimeMillis;if(wa)this.pullCount++;this.pullStartTimeMillis=0;},reportPingSent:function(){if(!this.enabled)return;this.pingCount++;},transportEnteredState:function(wa){if(!this.enabled)return;if(wa=='pull'){this.reportPullSent();}else if(wa='ping')this.reportPingSent();},doSerialize:function(){if(!this.enabled)return "";return (this.getUptimeSeconds()).toFixed(0)+','+(this.getAccumulatedPullTimeSeconds()).toFixed(0)+','+(this.getPingToPullRatio()).toFixed(2);}},oa=1,pa={},qa=0;function ra(){return i.lastSuccessTime?Math.round((Date.now()-i.lastSuccessTime)/1000):-1;}function sa(){var wa={};if(ha.getConfig('host'))wa[ha.getConfig('user_channel')]=ha.getConfig('seq',0);return wa;}function ta(){var wa=Date.now(),xa=Date.now(),ya={total:0},za='idle',ab=false;x.subscribe([x.USER,x.ONLINE,x.TIME_TRAVEL],function(db,eb){va(true);xa=null;ha.lastPullTime=Date.now();var fb;switch(db){case x.USER:fb=x.isPageOwner()?j.SYS_OWNER:j.SYS_NONOWNER;break;case x.ONLINE:fb=eb?j.SYS_ONLINE:j.SYS_OFFLINE;break;case x.TIME_TRAVEL:fb=j.SYS_TIMETRAVEL;break;}ha.exitState({status:fb,stateId:oa});});var bb=function(db,eb){var fb=Date.now(),gb;if(eb){wa=fb;gb=eb.nextState||eb.state;}else gb=za;x.checkTimeTravel();if(xa){var hb=Math.round((fb-xa)/1000);if(hb>0){ya[za]=(ya[za]||0)+hb;ya.total+=hb;}}za=gb;xa=fb;if(!db){ya.lastSuccessTime=ra();ya.online=x.isOnline();ia.log('rollup',ya);}};h.subscribe(j.ON_ENTER_STATE,bb);da(bb,60000);h.subscribe(s.DUMP_EVENT,function(db,eb){eb.channelRollup=ya;});var cb=function(){if(ha.isShutdown()||ha.shouldIdle())return;x.checkTimeTravel();var db=Date.now()-(ha.lastPullTime||p.start);if(!ab&&db>ma.STALL_THRESHOLD){var eb=ra();ia.error('stall',{lastSuccessTime:eb,rollupState:za});ab=true;}var fb=Date.now()-wa;if(ha.state=='pull'&&fb>ma.JUMPSTART_THRESHOLD){wa=null;ia.warn('jumpstart',{state:ha.state,dormant:fb});ha.enterState('init');}};da(cb,10000);}function ua(){var wa=Date.now(),xa=1;function ya(){ea(ya,xa*1000);var db=ha.state;if(db=='idle'&&ha.shouldIdle())return;ia.bump('conn_t',xa);if(db=='pull')ia.bump('conn_t_pull',xa);}ya();var za=[15,30,60,120,240],ab=false,bb=false;function cb(db){ea(function(){ia.rate('pullenter_'+db,ab);ia.rate('pullexit_'+db,bb);},db*1000);}while(za.length)cb(za.shift());h.subscribe(j.ON_ENTER_STATE,function(db,eb){if(eb.state=='pull')ab=true;wa=Date.now();});h.subscribe(j.ON_EXIT_STATE,function(db,eb){if(eb.state!='pull'||!wa)return;var fb='other';if(eb.status==j.OK){bb=true;fb='ok';}else if(eb.xhr&&eb.xhr.errorType){fb=/ar:(\w+)/.test(eb.xhr.errorType)&&RegExp.$1;}else if(/^sys_/.test(eb.status))return;var gb=(Date.now()-wa)/1000;if(gb<0){return;}else if(gb>3600)gb=3600;ia.bump('conn_num');ia.bump('conn_exit',gb);ia.bump('conn_num_'+fb);ia.bump('conn_exit_'+fb,gb);});}function va(wa){if(wa){qa=0;pa={};}else qa++;}ha={state:'idle',nextState:null,lastPullTime:Date.now(),lastReportOnMisguidedMsgTime:Date.now(),heartbeats:[],setTestCallback:ka,backoff:false,init:function(wa){this.init=function(){};var xa=!!ma.use_sticky_session,ya=null;if(xa&&fa){for(var za=0;za<fa.length;za++){var ab=fa.key(za);if(ab.indexOf(ga)===0){ya=fa.getItem(ab);break;}}if(!ya){ya=ma.sessionID;fa.setItem(ga,ya);}}var bb=!!ma.send_active_when_offline;if(!bb&&!n.isOnline())ma.userActive=0;na.enabled=!!ma.watchdog_enabled;ma.watchdog=na;if(typeof(z)!='undefined'){z.subscribe(function(){if(bb||n.isOnline())ma.userActive=Date.now();}.bind(this));}else ia.error('user_activity_undefined');u.register('ch',sa);var cb=this.getConfig('max_conn',2);ma.subdomain=l.allocate(cb);if(ya)ma.sessionID=ya;this._transportRate=new t(30000);var db=(g.supportsCORS()&&!ma.forceIframe)?'CORSTransport':'IframeTransport';this.transport=new m[db](this);if(wa)this.enterState.apply(this,arguments);h.subscribe(s.DUMP_EVENT,function(event,fb){fb.transportRate=this._transportRate.tally();fb.transportType=db;fb.transportVersion=2;}.bind(this));ta();ua();if(ha.getConfig('tryStreaming')&&ha.getConfig('host')&&g.supportsCORS()&&!ma.forceIframe){var eb=ma.MIN_INIT_PROBE_DELAY+Math.random()*ma.INIT_PROBE_DELAY_RANDOMIZE_RANGE;ea(this._probeTest,eb);}},configure:function(){var wa=ca(arguments);ia.log('configure',wa);wa.forEach(ba.bind(null,ma));h.inform(j.ON_CONFIG,this);},getConfig:function(wa,xa){return wa in ma?ma[wa]:xa;},isShutdown:function(){return this.state=='shutdown';},shouldIdle:function(){return !(x.isPageOwner()&&x.isOnline());},_sendIframeError:function(wa){var xa=new i().setURI('/ajax/presence/reconnect.php').setData({reason:wa,fb_dtsg:o.getToken()}).setOption('suppressErrorHandlerWarning',true).setOption('retries',1).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true);xa.specifiesWriteRequiredParams()&&xa.send();},_getDelay:function(){var wa=Math.min(ma.MIN_RETRY_INTERVAL*Math.pow(2,Math.max(0,qa-1)),ma.MAX_RETRY_INTERVAL);return Math.floor(wa*(1+Math.random()*.5));},enterState:function(){if(this._inEnterState)ia.warn('enterstate_recursion');this._inEnterState=true;try{this._enterState.apply(this,arguments);this._inEnterState=false;}catch(wa){this._inEnterState=false;throw wa;}},_enterState:function(wa){var xa=this.backoff?this._getDelay():0;this.backoff=false;var ya=ca(arguments);if(this.isShutdown())return;if(wa!='idle!'&&this.shouldIdle())return;oa++;ma.stateId=oa;clearTimeout(this._deferredTransition);this._deferredTransition=null;this.transport.enterState('idle');this.state='idle';this.nextState=null;if(/!$/.test(wa)){var za=this._transportRate.tally().timeAverage,ab=ha.getConfig('MAX_CHANNEL_STATES_PER_SEC',1);if(za>=ab){if(!this._throttled){this._throttled=true;ia.warn('throttled');}ia.bump('throttle');xa=1000/ab;}}else if(!(/#$/.test(wa)))xa=this._getDelay();wa=wa.replace(/\W*$/,'');if(!la[wa])throw new Error('invalid state:'+wa);var bb;if(xa<=0){bb={state:wa};this._transportRate.add(1);this.state=wa;var cb=this['_enter_'+this.state];if(cb){ya.shift();cb.apply(this,ya);}if(/init|idle|pull|ping/.test(this.state)){if(ma.streamingCapable&&/pull/.test(this.state))this.heartbeats=[];na.transportEnteredState(wa);ma.is_offline=!n.isOnline();this.transport.enterState(this.state,ma);if(this.state=='ping'){bb.url=m.getURI(ma).toString();bb.port=ma.port||'undefined';}}}else{this.state='idle';this.nextState=wa;bb={state:this.state,delay:xa,nextState:wa};ya[0]=wa+'#';this._deferredTransition=ea((function(){this._deferredTransition=null;this.enterState.apply(this,ya);}).bind(this),xa);}if(/pull/.test(wa)){bb.client_id=ma.sessionID;bb.streaming=ma.inStreaming;}ia.log('enter_'+this.state,bb);h.inform(j.ON_ENTER_STATE,bb);},exitState:function(wa,xa){var ya=wa.stateId,za=wa.status;if(this.isShutdown()||ya<oa)return;var ab=ca(arguments),bb=this.state;ab[0]=wa.status;var cb={state:bb,status:za};if(/pull/.test(bb)){cb.client_id=ma.sessionID;cb.streaming=ma.inStreaming;}if(/ping/.test(bb)&&za!=j.OK)cb.url=m.getURI(ma).toString();if(this.nextState)cb.nextState=this.nextState;if(xa&&xa.errorType){cb.xhr=xa.toJSON?xa.toJSON():xa;delete cb.xhr.json;}if(xa&&xa.json){if(xa.json.t)cb.t=xa.json.t;if(xa.json.reason)cb.reason=xa.json.reason;if(xa.json.seq)cb.seq=xa.json.seq;}ia.log('exit_'+bb,cb);h.inform(j.ON_EXIT_STATE,cb);var db=this['_exit_'+bb];if(db)za=db.apply(this,ab)||za;if(za!=j.OK){va();pa[bb]=(pa[bb]||0)+1;}var eb=la[this.nextState||bb][za]||la._all[za],fb=eb&&eb.replace(/!*$/,'');if(!fb){ia.error('terminal_transition',cb);this._shutdownHint=j.HINT_INVALID_STATE;eb='shutdown!';}this._lastState=bb;this._lastStatus=za;this.enterState(eb);},_processTransportData:function(wa,xa){var ya=xa.json,za=ya.t;if('s' in ya){ya.seq=ya.s;delete ya.s;}if(ya.u&&ma.user&&ya.u!=ma.user){ia.warn('misguided_msg',{user:ma.user,target:ya.u});this._reportProxyMisguidedMsg(ya.u,ma.user);return;}var ab=ma.seq;if('seq' in ya){ma.seq=ya.seq;v.doSync();}switch(za){case 'continue':if(ma.inStreaming&&this.heartbeats.length<1){ma.streamingCapable=false;ia.log('switch_to_longpoll');ea(this._probeTest,ma.PROBE_DELAY);}va(true);if(!ma.inStreaming||ma.STREAMING_EXIT_STATE_ON_CONTINUE)this.exitState({status:j.OK,stateId:wa});break;case 'refresh':case 'refreshDelay':this.exitState({status:'refresh_'+(ya.reason||0),stateId:wa},xa);break;case 'backoff':va();this.backoff=true;break;case 'lb':var bb=ya.lb_info;if(bb){ma.host=bb.vip;ma.sticky_token=bb.sticky;}else ia.error('bad lb info');break;case 'test_streaming':ea(this._probeTest,500);break;case 'fullReload':u.clear();ia.log('invalid_history');h.inform(j.ON_INVALID_HISTORY);va(true);this.exitState({status:j.ERROR_MISSING,stateId:wa},xa);break;case 'msg':var cb,db,eb,fb;va(true);if('tr' in ya)ma.trace_id=ya.tr;db=ya.ms;eb=ma.seq-db.length;for(cb=0;cb<db.length;cb++,eb++)if(eb>=ab){fb=db[cb];if(fb.type){if(fb.type==='messaging'){var gb={type:'messaging',event:fb.event};if(fb.message){gb.inbox_unread=fb.unread_counts&&fb.unread_counts.inbox;gb.tid=fb.message.tid;gb.mid=fb.message.mid;}ia.debug('message',gb);}else if(fb.type==='m_messaging'){ia.debug('message',{type:'m_messaging',tid:fb.tid,mid:fb.uuid});}else ia.debug('message',{type:fb.type});h.inform(j.getArbiterType(fb.type),{obj:fb});}}else ia.warn('seq_regression',{seq:eb,last_seq:ab,messages:db.length});break;case 'heartbeat':if(ma.inStreaming){var hb=Date.now();if(this.heartbeats.length>0){var ib=hb-this.heartbeats[this.heartbeats.length-1];ia.log('heartbeat_interval',{client_id:ma.sessionID,interval:ib});}this.heartbeats.push(hb);}break;default:ia.error('unknown_msg_type',{type:za});break;}},_enter_init:function(){if(pa.init>=ha.getConfig('MAX_INIT_FAILS',2))return setTimeout(this.exitState.bind(this,{status:j.ERROR_MAX,stateId:oa}),0);this._initTimer=ea(this.exitState.bind(this,{status:j.ERROR,stateId:oa},'timeout'),ma.IFRAME_LOAD_TIMEOUT);},_enter_reconnect:function(wa){var xa=oa;if(!w.hasUserCookie()){ia.warn('no_user_cookie');setTimeout(function(){ha._shutdownHint=j.HINT_AUTH;ha.exitState({status:j.ERROR_SHUTDOWN,stateId:xa});},0);return;}var ya={reason:wa,fb_dtsg:o.getToken()};if(r.token)ya.fb_isb=r.token;if(ja)ja(ya);var za=new q('GET','/ajax/presence/reconnect.php',ya);za.onSuccess=(function(){ha.configure(za.json);u.store();this.exitState({status:j.OK,stateId:xa});}).bind(this);za.onError=(function(){var ab=za.json&&za.json.error;if(za.errorType==g.TRANSPORT_ERROR||za.errorType==g.PROXY_ERROR)this._shutdownHint=j.HINT_CONN;if(ab&&ab==1356007){this._shutdownHint=j.HINT_MAINT;}else if(ab==1357001||ab==1357004||ab==1348009){this._shutdownHint=j.HINT_AUTH;}else this._shutdownHint=null;this.exitState({status:this._shutdownHint?j.ERROR_SHUTDOWN:j.ERROR,stateId:xa},za);}).bind(this);za.send();},_enter_shutdown:function(){h.inform(j.ON_SHUTDOWN,{reason:this._shutdownHint});},_exit_init:function(wa){if(this._initTimer)this._initTimer=clearTimeout(this._initTimer);if(wa==j.ERROR_MAX)this._sendIframeError(j.reason_IFrameLoadGiveUp);},_exit_pull:function(wa){var xa=wa==j.OK;na.reportPullReturned(xa);if(xa)this.lastPullTime=Date.now();},_exit_ping:function(wa){if(wa==j.OK){var xa=Date.now()-(this.lastPullTime||p.start);if(xa>ma.STALL_THRESHOLD)return j.ERROR_STALE;}},_reportProxyMisguidedMsg:function(wa,xa){var ya=Date.now();if(ya-this.lastReportOnMisguidedMsgTime<=ma.CHANNEL_PROXY_REPORTING_MIN_INTERVAL)return;this.lastReportOnMisguidedMsgTime=ya;var za={received_uid:wa,expected_uid:xa};if(ma.sticky_token)za.sticky_token=ma.sticky_token;var ab=new y('/err_misguided_msg').setDomain(ma.host+'.facebook.com').setPort(ma.port).setSecure(y().isSecure()).setQueryData(za),bb=new g('GET',ab);if(g.supportsCORS())bb.xhr.withCredentials=true;bb.onSuccess=function(cb){};bb.onError=function(cb){};bb.onJSON=function(cb,db){};bb.send();},_probeTest:function(){ma.streamingCapable=false;var wa=[],xa={mode:'stream',format:'json'};if(ma.sticky_token)xa.sticky_token=ma.sticky_token;var ya=new y('/probe').setDomain(ma.host+'.facebook.com').setPort(ma.port).setSecure(y().isSecure()).setQueryData(xa),za=new g('GET',ya);za.onJSON=function(ab,bb){if(ab&&ab.json&&ab.json.t==='heartbeat'){wa.push(Date.now());if(wa.length>=2){var cb=wa[1]-wa[0];if(cb>=ma.PROBE_HEARTBEATS_INTERVAL_LOW&&cb<=ma.PROBE_HEARTBEATS_INTERVAL_HIGH){ma.streamingCapable=true;ia.log('switch_to_streaming');}ia.log('probe_ok',{time:cb});}}};za.onSuccess=function(ab){if(wa.length!=2){ma.streamingCapable=false;ia.error('probe_error',{error:'beats.length = '+wa.length});}};za.onError=function(ab){ma.streamingCapable=false;ia.error('probe_error',ab);};ia.log('probe_request');za.send();}};e.exports=ha;if(k.channelConfig){ha.configure(k.channelConfig);if(/shutdown/.test(k.state))ha._shutdownHint=j[k.reason];ha.init(k.state,k.reason);}},null);
__d("ChannelConnection",["Arbiter","copyProperties","ChatConfig","Run","SystemEvents","ChannelConstants","ChannelManager","JSLogger","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=n.create('channel_connection'),q=null,r=null,s=null,t=null,u=0,v=h(new g(),{CONNECTED:'chat-connection/connected',RECONNECTING:'chat-connection/reconnecting',SHUTDOWN:'chat-connection/shutdown',MUTE_WARNING:'chat-connection/mute',UNMUTE_WARNING:'chat-connection/unmute'});function w(){if(r){clearTimeout(r);r=null;}}function x(){w();p.log('unmute_warning');v.inform(v.UNMUTE_WARNING);}function y(ba){w();r=o(x,ba);p.log('mute_warning',{time:ba});v.inform(v.MUTE_WARNING);}function z(){if(s){clearTimeout(s);s=null;}}function aa(ba,ca){z();if(ba===l.ON_ENTER_STATE&&(ca.nextState||ca.state)==='pull'){if(t!==v.CONNECTED){p.log('connected');var da=!t;t=v.CONNECTED;u=0;v.inform(v.CONNECTED,{init:da});}}else if(ba===l.ON_ENTER_STATE&&((ca.nextState||ca.state)==='ping'||(!ca.nextState&&ca.state==='idle'))){s=o(function(){var ea=null;if(!(ca.state==='idle'&&!ca.nextState))ea=(ca.delay||0);p.log('reconnecting',{delay:ea});if(v.disconnected())p.log('reconnecting_ui',{delay:ea});t=v.RECONNECTING;(ca.state==='idle')&&u++;if(u>1){v.inform(v.RECONNECTING,ea);}else if(!ca.nextState&&ca.state==='idle')aa(ba,ca);},500);}else if(ba===l.ON_SHUTDOWN){p.log('shutdown',{reason:ca.reason});t=v.SHUTDOWN;u=0;v.inform(v.SHUTDOWN,ca.reason);}}if(m.isShutdown()){aa(l.ON_SHUTDOWN,m._shutdownHint);}else aa(l.ON_ENTER_STATE,{state:m.state,nextState:m.nextState,delay:0});h(v,{disconnected:function(){return t===v.SHUTDOWN||(t===v.RECONNECTING&&!r&&u>1);},isShutdown:function(){return t===v.SHUTDOWN;},reconnect:function(ba){if(m.state==='ping'||m.isShutdown())return;p.log('reconnect',{now:ba});v.inform(v.RECONNECTING,0);if(!!ba){if(q!==null){clearTimeout(q);q=null;}m.enterState('ping!');}else if(!q)q=o(function(){m.enterState('ping!');q=null;},i.get('channel_manual_reconnect_defer_msec'));},unmuteWarning:x});g.subscribe([l.ON_ENTER_STATE,l.ON_SHUTDOWN],aa);g.subscribe(l.ATTEMPT_RECONNECT,function(){if(v.disconnected())v.reconnect();});k.subscribe(k.TIME_TRAVEL,function(){v.reconnect();y(i.get('mute_warning_time_msec'));});j.onBeforeUnload(z,false);e.exports=v;},null);
__d("ChatContexts",[],function(a,b,c,d,e,f){var g={};function h(k){var l=k?k.subtext:'';return l;}function i(k,l){g[k]=l;}var j={get:function(k){if(k in g){return g[k];}else return null;},update:function(k){for(var l in k)i(l,k[l]);},getShortDisplay:function(k){return h(j.get(k));}};e.exports=j;},null);
__d("PresencePoller",["AvailableListConstants","AvailableListInitialData","BanzaiODS","ChannelConnection","ChatContexts","ChatVisibility","CurrentUser","JSLogger","LastMobileActiveTimes","Poller","PresencePrivacy","PresenceStatus","ServerTime","ShortProfiles","UserActivity","copyProperties","debounceAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){var x=5,y='/ajax/chat/buddy_list.php',z=1800000,aa=h.pollInterval,ba=h.lazyPollInterval,ca=h.lazyThreshold,da=n.create('available_list'),ea='presence_poller';i.setEntitySample(ea,.01);function fa(ga){"use strict";this.$PresencePoller0=ga;this.$PresencePoller1=false;this.$PresencePoller2=h.chatNotif;this.$PresencePoller3=new p({interval:aa,setupRequest:this.$PresencePoller4.bind(this),clearOnQuicklingEvents:false,dontStart:true});if(l.isOnline()){this.$PresencePoller5=Date.now();this.$PresencePoller6=Date.now();this.$PresencePoller7=Date.now();this.$PresencePoller8=h.updateTime;}else{this.$PresencePoller5=0;this.$PresencePoller8=0;this.$PresencePoller6=0;this.$PresencePoller7=0;}this.$PresencePoller9=0;this.$PresencePollera('available_initial_data',h.updateTime,h.availableList,h.lastActiveTimes,h.mobileFriends,h.birthdayFriends);u.subscribe(function(ha,ia){if(ia.idleness>aa)this.forceUpdate();}.bind(this));q.subscribe('privacy-user-presence-changed',function(){this.forceUpdate();}.bind(this));}fa.prototype.start=function(){"use strict";setTimeout(this.$PresencePoller3.start.bind(this.$PresencePoller3),0);};fa.prototype.restart=function(){"use strict";if(this.$PresencePoller3.isMuted()){this.$PresencePoller3.resume();this.forceUpdate();}};fa.prototype.stop=function(){"use strict";this.$PresencePoller3.mute();};fa.prototype.forceUpdate=function(){"use strict";this.$PresencePoller3.request();};fa.prototype.getIsUserIdle=function(){"use strict";return this.$PresencePoller1;};fa.prototype.getWebChatNotification=function(){"use strict";return this.$PresencePoller2;};fa.prototype.getCallback=function(){"use strict";return this.$PresencePoller0;};fa.prototype.$PresencePollerb=function(){"use strict";return w(function(){this.$PresencePoller0(g.ON_AVAILABILITY_CHANGED);}.bind(this),0)();};fa.prototype.$PresencePollera=function(ga,ha,ia,ja,ka,la){"use strict";this.$PresencePoller8=ha;if(!Array.isArray(ia)){r.resetPresenceData();for(var ma in ia)r.set(ma,ia[ma].a,false,ga,ia[ma].c,ia[ma].p);}if(ja)o.update(ja);if(ka)r.setMobileFriends(ka);if(la)r.setBirthdayFriends(la);this.$PresencePollerb();};fa.prototype.$PresencePoller4=function(ga){"use strict";if(j.isShutdown()||!l.isOnline()){this.$PresencePoller3.skip();i.bumpEntityKey(ea,'skip.offline');return;}if(Date.now()-this.$PresencePoller5<aa){this.$PresencePoller3.skip();i.bumpEntityKey(ea,'skip.recent');return;}i.bumpEntityKey(ea,'request');this.$PresencePoller5=Date.now();var ha=Date.now()-this.$PresencePoller7,ia=t.getCachedProfileIDs().join(",");ga.setHandler(this.$PresencePollerc.bind(this)).setErrorHandler(this.$PresencePollerd.bind(this)).setOption('suppressErrorAlerts',true).setOption('retries',1).setData({user:m.getID(),cached_user_info_ids:ia,fetch_mobile:(ha>z)}).setURI(y).setAllowCrossPageTransition(true);};fa.prototype.$PresencePollerc=function(ga){"use strict";var ha=ga.getPayload(),ia=ha.buddy_list;if(!ia){this.$PresencePollerd(ga);return;}i.bumpEntityKey(ea,'response');this.$PresencePollere();this.$PresencePoller6=Date.now();s.update(ha.time);if(ia.mobile_friends)this.$PresencePoller7=Date.now();this.$PresencePoller9=0;this.$PresencePollerf();var ja=ia.userInfos;if(ja)t.setMulti(ja);var ka=ia.chatContexts;ka&&k.update(ka);this.$PresencePoller1=ia.userIsIdle;if(ia.chatNotif!==undefined){this.$PresencePoller2=ia.chatNotif;this.$PresencePoller0(g.ON_CHAT_NOTIFICATION_CHANGED,this.$PresencePoller2);}this.$PresencePollera('buddy_list_poller',ha.time,ia.nowAvailableList,ia.last_active_times,ia.mobile_friends,ia.todays_birthdays);};fa.prototype.$PresencePollerd=function(ga){"use strict";i.bumpEntityKey(ea,'error');if(ga.getError()==1356007)return;this.$PresencePoller9++;if(this.$PresencePoller9>=x)this.$PresencePoller0(g.ON_UPDATE_ERROR);};fa.prototype.$PresencePollerf=function(){"use strict";var ga=u.isActive(ca)?aa:ba;i.bumpEntityKey(ea,'period.'+ga);this.$PresencePoller3.setInterval(ga);};fa.prototype.$PresencePollere=function(){"use strict";var ga=Date.now(),ha=ga-this.$PresencePoller6;da.log('buddylist_presence_stats',v({duration:ha},r.getPresenceStats()));};e.exports=fa;},null);
__d("TypingStates",[],function(a,b,c,d,e,f){var g={INACTIVE:0,TYPING:1,QUITTING:2};e.exports=g;},null);
__d("AvailableList",["Arbiter","ArbiterMixin","AsyncRequest","AvailableListConstants","ChannelConnection","ChannelConstants","ChatConfig","JSLogger","PresencePoller","PresencePrivacy","PresenceStatus","ShortProfiles","TypingStates","copyProperties","debounceAcrossTransitions","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){var w=t({},j,h);w.subscribe([j.ON_AVAILABILITY_CHANGED,j.ON_UPDATE_ERROR],function(fa,ga){g.inform(fa,ga);});var x=u(function(){w.inform(j.ON_AVAILABILITY_CHANGED);},0);function y(fa,ga,ha,ia,ja){var ka=q.set(fa,ga,ha,ia,ja);if(ka)x();}function z(fa){var ga=fa.payload.availability||{};for(var ha in ga)y(ha,ga[ha],true,'mercury_tabs');}function aa(){ea.restart();}function ba(){ea.stop();}function ca(fa){var ga=w.getDebugInfo(fa),ha=(ga.presence==j.ACTIVE),ia=new i('/ajax/mercury/tabs_presence.php').setData({target_id:fa,to_online:ha,presence_source:ga.overlaySource,presence_time:ga.overlayTime}).setHandler(z).setErrorHandler(v).setAllowCrossPageTransition(true).send();}function da(fa,ga){ga.chat_config=m.getDebugInfo();ga.available_list_debug_info={};q.getAvailableIDs().forEach(function(ha){ga.available_list_debug_info[ha]=w.getDebugInfo(ha);});ga.available_list_poll_interval=w._poller&&w._poller.getInterval();}var ea=new o(function(event){w.inform(event);});t(w,{get:function(fa){return q.get(fa);},updateForID:function(fa){ca(fa);},getWebChatNotification:function(){return ea.getWebChatNotification();},isUserIdle:function(){return ea.getIsUserIdle();},isReady:function(){return true;},set:function(fa,ga,ha,ia){y(fa,ga,true,ha,ia);},update:function(){ea.forceUpdate();},isIdle:function(fa){return w.get(fa)==j.IDLE;},getDebugInfo:function(fa){var ga=q.getDebugInfo(fa),ha=r.getNow(fa);if(ha)ga.name=ha.name;return ga;}});ea.start();g.subscribe(n.DUMP_EVENT,da);g.subscribe('chat-visibility/go-online',aa);g.subscribe('chat-visibility/go-offline',ba);p.subscribe(['privacy-changed','privacy-availability-changed','privacy-user-presence-response'],x);k.subscribe([k.CONNECTED,k.RECONNECTING,k.SHUTDOWN,k.MUTE_WARNING,k.UNMUTE_WARNING],x);g.subscribe(l.getArbiterType('buddylist_overlay'),function(fa,ga){var ha=ga.obj.overlay;for(var ia in ha)w.set(ia,ha[ia].a,ha[ia].s||'channel',ha[ia].vc);});g.subscribe([l.getArbiterType('typ'),l.getArbiterType('ttyp')],function(fa,ga){var ha=ga.obj;if(ha.st===s.TYPING){var ia=ha.from;w.set(ia,j.ACTIVE,'channel-typing');}});a.AvailableList=e.exports=w;},null);
__d("LayerHideOnSuccess",["copyProperties"],function(a,b,c,d,e,f,g){function h(i){"use strict";this._layer=i;}h.prototype.enable=function(){"use strict";this._subscription=this._layer.subscribe('success',this._layer.hide.bind(this._layer));};h.prototype.disable=function(){"use strict";if(this._subscription){this._subscription.unsubscribe();this._subscription=null;}};g(h.prototype,{_subscription:null});e.exports=h;},null);
__d("Overlay",["CSS","DataStore","DOM","Layer","LayerButtons","LayerDestroyOnHide","LayerFadeOnHide","LayerFadeOnShow","LayerFormHooks","LayerHideOnBlur","LayerHideOnEscape","LayerHideOnSuccess","LayerHideOnTransition","LayerMouseHooks","LayerTabIsolation","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){for(var w in j)if(j.hasOwnProperty(w))y[w]=j[w];var x=j===null?null:j.prototype;y.prototype=Object.create(x);y.prototype.constructor=y;y.__superConstructor__=j;function y(z,aa){"use strict";z=v({buildWrapper:true},z||{});this._shouldBuildWrapper=z.buildWrapper;j.call(this,z,aa);}y.prototype._configure=function(z,aa){"use strict";x._configure.call(this,z,aa);var ba=this.getRoot();this._overlay=i.scry(ba,'div.uiOverlay')[0]||ba;g.hide(ba);i.appendContent(this.getInsertParent(),ba);h.set(this._overlay,'overlay',this);var ca=h.get(this._overlay,'width');ca&&this.setWidth(ca);if(this.setFixed)this.setFixed(h.get(this._overlay,'fixed')=='true');if(h.get(this._overlay,'fadeonshow')!='false')this.enableBehavior(n);if(h.get(this._overlay,'fadeonhide')!='false')this.enableBehavior(m);if(h.get(this._overlay,'hideonsuccess')!='false')this.enableBehavior(r);if(h.get(this._overlay,'hideonblur')=='true')this.enableBehavior(p);if(h.get(this._overlay,'destroyonhide')!='false')this.enableBehavior(l);return this;};y.prototype._getDefaultBehaviors=function(){"use strict";return x._getDefaultBehaviors.call(this).concat([k,o,t,q,s,u]);};y.prototype.initWithoutBuildingWrapper=function(){"use strict";this._shouldBuildWrapper=false;return this.init.apply(this,arguments);};y.prototype._buildWrapper=function(z,aa){"use strict";aa=x._buildWrapper.call(this,z,aa);if(!this._shouldBuildWrapper){this._contentRoot=aa;return aa;}this._contentRoot=i.create('div',{className:'uiOverlayContent'},aa);return i.create('div',{className:'uiOverlay'},this._contentRoot);};y.prototype.getContentRoot=function(){"use strict";return this._contentRoot;};y.prototype.destroy=function(){"use strict";h.remove(this.getRoot(),'overlay');x.destroy.call(this);};e.exports=y;},null);
__d("ContextualDialogFooterLink",["CSS","DOM","Event","copyProperties"],function(a,b,c,d,e,f,g,h,i,j){function k(l){"use strict";this._layer=l;}k.prototype.enable=function(){"use strict";var l=this._layer.getRoot(),m=h.scry(l,'.uiContextualDialogFooterLink')[0],n='uiContextualDialogHoverFooterArrow';this._subscriptions=[i.listen(m,'mouseenter',g.addClass.bind(null,l,n)),i.listen(m,'mouseleave',g.removeClass.bind(null,l,n))];};k.prototype.disable=function(){"use strict";this._subscriptions.forEach(function(l){l.remove();});this._subscriptions=null;};j(k.prototype,{_subscriptions:null});e.exports=k;},null);
__d("LegacyContextualDialog",["Arbiter","ArbiterMixin","ARIA","Bootloader","ContextualDialogFooterLink","ContextualThing","CSS","DataStore","DOM","Event","LayerAutoFocus","LayerRefocusOnHide","Locale","Overlay","Parent","Style","Vector","$","copyProperties","getOverlayZIndex","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){for(var ba in t)if(t.hasOwnProperty(ba))da[ba]=t[ba];var ca=t===null?null:t.prototype;da.prototype=Object.create(ca);da.prototype.constructor=da;da.__superConstructor__=t;function da(){"use strict";if(t!==null)t.apply(this,arguments);}da.prototype._configure=function(ea,fa){"use strict";ca._configure.call(this,ea,fa);var ga=this.getRoot(),ha=n.get.bind(null,ga);this.setAlignH(ha('alignh','left'));this.setOffsetX(ha('offsetx',0));this.setOffsetY(ha('offsety',0));this.setPosition(ha('position','above'));this._hasFooter=ha('hasfooter',false);if(this._hasFooter){var ia=o.scry(ga,'.uiContextualDialogFooterLink')[0];ia&&this.enableBehavior(k);}this.enableBehaviors(this._getDefaultBehaviors());this._setContextSubscription=this.subscribe('beforeshow',function(){this.unsubscribe(this._setContextSubscription);this._setContextSubscription=null;var ka=ha('context');if(ka){this.setContext(x(ka));}else{ka=ha('contextselector');if(ka)this.setContext(o.find(document,ka));}}.bind(this));this._content=o.scry(ga,'.uiContextualDialogContent')[0];if(this._content){this._content.setAttribute('role','dialog');var ja=o.scry(this._content,'.legacyContextualDialogTitle')[0];if(ja)this._content.setAttribute('aria-labelledby',o.getID(ja));}this._showSubscription=this.subscribe('show',function(){var ka=aa(this.updatePosition,this);this._resizeListener=p.listen(window,'resize',ka);this._reflowSubscription=g.subscribe('reflow',ka);this._setupScrollListener(this._scrollParent);l.register(ga,this.context);g.inform('layer_shown',{type:'ContextualDialog'});}.bind(this));this._hideSubscription=this.subscribe('hide',function(){this._teardownResizeAndReflowListeners();this._teardownScrollListener();g.inform('layer_hidden',{type:'ContextualDialog'});}.bind(this));return this;};da.prototype._getDefaultBehaviors=function(){"use strict";return ca._getDefaultBehaviors.call(this).concat([q,r]);};da.prototype._buildWrapper=function(ea,fa){"use strict";var ga=ca._buildWrapper.call(this,ea,fa);if(!this._shouldBuildWrapper)return ga;m.addClass(ga,'uiContextualDialog');return o.create('div',{className:'uiContextualDialogPositioner'},ga);};da.prototype.setWidth=function(ea){"use strict";this._width=Math.floor(ea);return this;};da.prototype.setFixed=function(ea){"use strict";ea=!!ea;m.conditionClass(this.getRoot(),'uiContextualDialogFixed',ea);this._fixed=ea;return this;};da.prototype.setAlignH=function(ea){"use strict";this.alignH=ea;this._updateAlignmentClass();this._shown&&this.updatePosition();this.position&&this._updateArrow();return this;};da.prototype.getContent=function(){"use strict";return this._content;};da.prototype.getContext=function(){"use strict";return this.context;};da.prototype.setContext=function(ea){"use strict";if(this._setContextSubscription){this.unsubscribe(this._setContextSubscription);this._setContextSubscription=null;}ea=x(ea);if(this.context&&this.context!=ea)n.remove(this.context,'LegacyContextualDialog');this.context=ea;i.setPopup(this.getCausalElement(),this.getRoot());var fa=u.byClass(ea,'fbPhotoSnowlift');this.setInsertParent(fa||document.body);if(this._scrollListener&&this._scrollParent!==fa){this._teardownScrollListener();this._setupScrollListener(fa);}this._scrollParent=fa;var ga=z(ea,this._insertParent);v.set(this.getRoot(),'z-index',ga>200?ga:'');n.set(this.context,'LegacyContextualDialog',this);return this;};da.prototype.getCausalElement=function(){"use strict";return ca.getCausalElement.call(this)||this.context;};da.prototype.listen=function(ea,fa){"use strict";return p.listen(this.getRoot(),ea,fa);};da.prototype.setOffsetX=function(ea){"use strict";this.offsetX=parseInt(ea,10)||0;this._shown&&this.updatePosition();return this;};da.prototype.setOffsetY=function(ea){"use strict";this.offsetY=parseInt(ea,10)||0;this._shown&&this.updatePosition();return this;};da.prototype.setPosition=function(ea){"use strict";this.position=ea;for(var fa in da.POSITION_TO_CLASS)m.conditionClass(this.getRoot(),da.POSITION_TO_CLASS[fa],ea==fa);this._updateAlignmentClass();this._shown&&this.updatePosition();this._updateArrow();return this;};da.prototype.updatePosition=function(){"use strict";if(!this.context)return false;if(this._width)v.set(this._overlay,'width',this._width+'px');var ea=this._fixed?'viewport':'document',fa=w.getElementPosition(this.context,ea),ga=this._scrollParent;if(ga)fa=fa.sub(w.getElementPosition(ga,'document')).add(ga.scrollLeft,ga.scrollTop);var ha=w.getElementDimensions(this.context),ia=this.position=='above'||this.position=='below',ja=s.isRTL();if((this.position=='right'||(ia&&this.alignH=='right'))!=ja)fa=fa.add(ha.x,0);if(this.position=='below')fa=fa.add(0,ha.y);var ka=new w(0,0);if(ia&&this.alignH=='center'){ka=ka.add((ha.x-this._width)/2,0);}else{var la=ia?ha.x:ha.y,ma=2*da.ARROW_INSET;if(la<ma){var na=la/2-da.ARROW_INSET;if(ia&&(this.alignH=='right'!=ja))na=-na;ka=ka.add(ia?na:0,ia?0:na);}}ka=ka.add(this.offsetX,this.offsetY);if(ja)ka=ka.mul(-1,1);fa=fa.add(ka);if(this._fixed)fa=new w(fa.x,fa.y,'document');fa.setElementPosition(this.getRoot());this._adjustVerticalPosition();this._adjustHorizontalPosition();return true;};da.prototype.scrollTo=function(){"use strict";if(this.context)j.loadModules(["DOMScroll"],function(ea){ea.scrollTo(this.context,true,true);}.bind(this));};da.prototype.destroy=function(){"use strict";this.unsubscribe(this._showSubscription);this.unsubscribe(this._hideSubscription);if(this._setContextSubscription){this.unsubscribe(this._setContextSubscription);this._setContextSubscription=null;}this._teardownScrollListener();this._teardownResizeAndReflowListeners();this.context&&n.remove(this.context,'LegacyContextualDialog');ca.destroy.call(this);};da.prototype._adjustVerticalPosition=function(){"use strict";if(this.position!='left'&&this.position!='right'){v.set(this._overlay,'top','');return;}var ea=this.getRoot(),fa=w.getElementPosition(ea,'viewport').y,ga=w.getElementDimensions(this._overlay).y,ha=w.getViewportDimensions().y,ia=Math.min(Math.max(fa,da.MIN_TOP_GAP),da.TOP_MARGIN),ja=Math.min(Math.max(0,fa+ga+da.BOTTOM_MARGIN-ha),Math.max(-ia,fa-ia),ga-2*da.ARROW_INSET);v.set(this._overlay,'top',(-1*ja)+'px');v.set(this._arrow,'top',da.ARROW_OFFSET+'px');v.set(this._arrow,'marginTop',ja+'px');};da.prototype._adjustHorizontalPosition=function(){"use strict";if((this.position!='above'&&this.position!='below')||this.alignH!='left'){v.set(this._overlay,'left','');v.set(this._overlay,'right','');return;}var ea=this.getRoot(),fa=w.getElementPosition(ea,'viewport').x,ga=w.getElementDimensions(this._overlay).x,ha=w.getViewportDimensions().x,ia=s.isRTL(),ja;if(!ia){ja=fa+ga+da.RIGHT_MARGIN-ha;}else ja=da.LEFT_MARGIN+ga-fa;ja=Math.min(Math.max(0,ja),ga-2*da.ARROW_INSET);v.set(this._overlay,ia?'right':'left',-1*ja+'px');v.set(this._arrow,ia?'right':'left',da.ARROW_OFFSET+'px');v.set(this._arrow,ia?'marginRight':'marginLeft',ja+'px');};da.prototype._updateArrow=function(){"use strict";var ea=0;if(this.position=='above'||this.position=='below')switch(this.alignH){case 'center':ea=50;break;case 'right':ea=100;break;}this._renderArrow(da.POSITION_TO_ARROW[this.position],ea);};da.prototype._renderArrow=function(ea,fa){"use strict";for(var ga in da.ARROW_CLASS)m.conditionClass(this._overlay,da.ARROW_CLASS[ga],ea==ga);m.conditionClass(this._overlay,'uiContextualDialogWithFooterArrowBottom',ea=='bottom'&&this._hasFooter);if(ea=='none')return;if(!this._arrow){this._arrow=o.create('i',{className:'uiContextualDialogArrow'});o.appendContent(this._overlay,this._arrow);}v.set(this._arrow,'top','');v.set(this._arrow,'left','');v.set(this._arrow,'right','');v.set(this._arrow,'margin','');var ha=ea=='top'||ea=='bottom',ia=ha?(s.isRTL()?'right':'left'):'top';fa=fa||0;v.set(this._arrow,ia,fa+'%');var ja=da.ARROW_LENGTH+da.ARROW_OFFSET*2,ka=-(ja*fa/100-da.ARROW_OFFSET);v.set(this._arrow,'margin-'+ia,ka+'px');};da.prototype._updateAlignmentClass=function(){"use strict";m.conditionClass(this.getRoot(),da.RIGHT_ALIGNED_CLASS,(this.position=='above'||this.position=='below')&&this.alignH=='right');};da.prototype._setupScrollListener=function(ea){"use strict";this._scrollListener=p.listen(ea||window,'scroll',aa(this._adjustVerticalPosition,this));};da.prototype._teardownScrollListener=function(){"use strict";if(this._scrollListener){this._scrollListener.remove();this._scrollListener=null;}};da.prototype._teardownResizeAndReflowListeners=function(){"use strict";if(this._resizeListener){this._resizeListener.remove();this._resizeListener=null;}if(this._reflowSubscription){this._reflowSubscription.unsubscribe();this._reflowSubscription=null;}};da.getInstance=function(ea){"use strict";var fa=n.get(ea,'LegacyContextualDialog');if(!fa){var ga=u.byClass(ea,'uiOverlay');if(ga)fa=n.get(ga,'overlay');}return fa;};y(da,h,{ARROW_OFFSET:15,ARROW_LENGTH:16,ARROW_INSET:22,TOP_MARGIN:50,BOTTOM_MARGIN:30,LEFT_MARGIN:15,RIGHT_MARGIN:30,MIN_TOP_GAP:5,POSITION_TO_CLASS:{above:'uiContextualDialogAbove',below:'uiContextualDialogBelow',left:'uiContextualDialogLeft',right:'uiContextualDialogRight'},RIGHT_ALIGNED_CLASS:'uiContextualDialogRightAligned',ARROW_CLASS:{bottom:'uiContextualDialogArrowBottom',top:'uiContextualDialogArrowTop',right:'uiContextualDialogArrowRight',left:'uiContextualDialogArrowLeft'},POSITION_TO_ARROW:{above:'bottom',below:'top',left:'right',right:'left'}});y(da.prototype,{_scrollListener:null,_scrollParent:null,_width:null,_fixed:false,_hasFooter:false,_showSubscription:null,_hideSubscription:null,_setContextSubscription:null,_resizeListener:null,_reflowSubscription:null});e.exports=da;},null);